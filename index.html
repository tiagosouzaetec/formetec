<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="https://bkpsitecpsnew.blob.core.windows.net/uploadsitecps/sites/226/2025/08/logo-512-2.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');
      body {
        font-family: 'Inter', sans-serif;
        position: relative;
      }
      /* Estilos para o background com overlay */
      body::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: url('https://bkpsitecpsnew.blob.core.windows.net/uploadsitecps/sites/226/2025/08/bg-footer-ed-azul-base-2.png');
        background-size: contain;
        background-position: right;
        background-repeat: no-repeat;
        z-index: -2;
      }
      body::after {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: #005C6D;
        opacity: 0.98; /* Ajuste a opacidade conforme necessário */
        z-index: -1;
      }
      .hidden-field {
        display: none;
      }
    </style>
  </head>
  <body class="flex items-center justify-center min-h-screen p-4">
    <div class="bg-white p-8 rounded-xl shadow-2xl w-full max-w-2xl">
      <!-- Cabeçalho com Logo e Título -->
      <div class="flex flex-col sm:flex-row items-center justify-center text-center sm:text-left gap-4 mb-8">
        <img 
          src="https://bkpsitecpsnew.blob.core.windows.net/uploadsitecps/sites/226/2025/08/logo-512.jpg" 
          alt="Logotipo da Empresa" 
          class="h-20 w-20 rounded-lg object-cover"
          onerror="this.onerror=null; this.src='https://placehold.co/80x80/B20000/FFFFFF?text=Logo';"
        >
        <h1 class="text-2xl font-bold text-[#005C6D]">Inscrição - Vagas Remanescentes de 1° Módulo</h1>
      </div>

      <form id="contactForm" class="space-y-8">
        
        <!-- Seção: Verificação de CPF -->
        <div id="section-cpf" class="space-y-6">
          <h2 class="text-xl font-bold text-[#005C6D] border-b-2 border-gray-200 pb-2">Cadastro</h2>
          
          <div>
            <label for="cpfInput" class="block text-gray-700 font-medium mb-2">CPF<span class="text-[#B20000]">*</span></label>
            <input
              type="text"
              id="cpfInput"
              placeholder="000.000.000-00"
              maxlength="14"
              required
              class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#B20000] focus:border-transparent transition duration-200"
            />
          </div>

          <div>
            <label for="dataNascimentoInput" class="block text-gray-700 font-medium mb-2">Data de Nascimento<span class="text-[#B20000]">*</span></label>
            <input
              type="date"
              id="dataNascimentoInput"
              required
              class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#B20000] focus:border-transparent transition duration-200"
            />
          </div>

          <button
            type="button"
            id="nextButton"
            class="w-full bg-[#B20000] text-white font-bold py-3 px-4 rounded-lg hover:bg-[#8e0000] transition duration-200 shadow-md"
          >
            Iniciar Inscrição
          </button>
        </div>

        <!-- Seções do formulário principal (ocultas inicialmente) -->
        <div id="sections-principal" class="hidden-field space-y-8">

          <!-- Seção: Dados Pessoais -->
          <fieldset class="border-t-2 border-gray-200 pt-6">
            <legend class="text-xl font-bold text-[#005C6D] mb-4 px-2">Dados Pessoais</legend>
            <div class="space-y-4">
              <!-- Campos de Dados Pessoais aqui... -->
              <div>
                <label for="nomeInput" class="block text-gray-700 font-medium mb-2">Nome<span class="text-[#B20000]">*</span></label>
                <input type="text" id="nomeInput" placeholder="Seu nome completo" required class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#B20000] focus:border-transparent transition duration-200"/>
              </div>
              <div>
                <label for="nomeSocialInput" class="block text-gray-700 font-medium mb-2">Nome Social</label>
                <input type="text" id="nomeSocialInput" placeholder="Seu nome social" class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#B20000] focus:border-transparent transition duration-200"/>
              </div>
              <div id="documentacaoNomeSocialGroup" class="hidden-field">
                <label for="documentacaoNomeSocialInput" class="block text-gray-700 font-medium mb-2">Documentação para Nome Social (Conforme o Edital)<span class="text-[#B20000]">**</span></label>
                <input type="file" id="documentacaoNomeSocialInput" class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#B20000] focus:border-transparent transition duration-200"/>
              </div>
              <div>
                <label for="rgInput" class="block text-gray-700 font-medium mb-2">RG<span class="text-[#B20000]">*</span></label>
                <input type="text" id="rgInput" placeholder="00.000.000-X" required maxlength="12" class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#B20000] focus:border-transparent transition duration-200"/>
              </div>
              <div class="flex space-x-2">
                <div class="w-1/2">
                  <label for="ufInput" class="block text-gray-700 font-medium mb-2">UF<span class="text-[#B20000]">*</span></label>
                  <select id="ufInput" required class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#B20000] focus:border-transparent transition duration-200">
                    <option value="">Selecione</option><option value="AC">AC</option><option value="AL">AL</option><option value="AP">AP</option><option value="AM">AM</option><option value="BA">BA</option><option value="CE">CE</option><option value="DF">DF</option><option value="ES">ES</option><option value="GO">GO</option><option value="MA">MA</option><option value="MT">MT</option><option value="MS">MS</option><option value="MG">MG</option><option value="PA">PA</option><option value="PB">PB</option><option value="PR">PR</option><option value="PE">PE</option><option value="PI">PI</option><option value="RJ">RJ</option><option value="RN">RN</option><option value="RS">RS</option><option value="RO">RO</option><option value="RR">RR</option><option value="SC">SC</option><option value="SP" selected>SP</option><option value="SE">SE</option><option value="TO">TO</option>
                  </select>
                </div>
                <div class="w-1/2">
                  <label for="orgaoEmissorInput" class="block text-gray-700 font-medium mb-2">Órgão Emissor<span class="text-[#B20000]">*</span></label>
                  <select id="orgaoEmissorInput" required class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#B20000] focus:border-transparent transition duration-200">
                    <option value="">Selecione</option><option value="SSP" selected>SSP</option><option value="DETRAN">DETRAN</option><option value="DIC">DIC</option><option value="IFP">IFP</option><option value="IML">IML</option><option value="CBM">CBM</option><option value="PC">PC</option><option value="PM">PM</option><option value="CREA">CREA</option><option value="OAB">OAB</option>
                  </select>
                </div>
              </div>
              <div>
                <label for="celularInput" class="block text-gray-700 font-medium mb-2">Celular<span class="text-[#B20000]">*</span></label>
                <input type="text" id="celularInput" placeholder="(00) 00000-0000" maxlength="15" required class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#B20000] focus:border-transparent transition duration-200"/>
              </div>
              <div>
                <label for="emailInput" class="block text-gray-700 font-medium mb-2">E-mail<span class="text-[#B20000]">*</span></label>
                <input type="email" id="emailInput" placeholder="seu.email@exemplo.com" required class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#B20000] focus:border-transparent transition duration-200"/>
              </div>
              <div>
                <label class="block text-gray-700 font-medium mb-2">Candidato com deficiência?<span class="text-[#B20000]">*</span></label>
                <div class="flex items-center space-x-4"><div class="flex items-center"><input type="radio" id="deficienciaSim" name="candidatoDeficiencia" value="sim" required class="w-4 h-4 text-[#B20000] bg-gray-100 border-gray-300 focus:ring-[#B20000]"><label for="deficienciaSim" class="ml-2 text-gray-700">Sim</label></div><div class="flex items-center"><input type="radio" id="deficienciaNao" name="candidatoDeficiencia" value="nao" required class="w-4 h-4 text-[#B20000] bg-gray-100 border-gray-300 focus:ring-[#B20000]"><label for="deficienciaNao" class="ml-2 text-gray-700">Não</label></div></div>
              </div>
              <div id="tipoDeficienciaGroup" class="hidden-field">
                <label for="tipoDeficienciaInput" class="block text-gray-700 font-medium mb-2">Tipo de deficiência<span class="text-[#B20000]">**</span></label>
                <input type="text" id="tipoDeficienciaInput" placeholder="Ex: Visual, Auditiva, etc." class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#B20000] focus:border-transparent transition duration-200"/>
              </div>
              <div>
                <label class="block text-gray-700 font-medium mb-2">Candidato com TEA?<span class="text-[#B20000]">*</span></label>
                <div class="flex items-center space-x-4"><div class="flex items-center"><input type="radio" id="teaSim" name="candidatoTEA" value="sim" required class="w-4 h-4 text-[#B20000] bg-gray-100 border-gray-300 focus:ring-[#B20000]"><label for="teaSim" class="ml-2 text-gray-700">Sim</label></div><div class="flex items-center"><input type="radio" id="teaNao" name="candidatoTEA" value="nao" required class="w-4 h-4 text-[#B20000] bg-gray-100 border-gray-300 focus:ring-[#B20000]"><label for="teaNao" class="ml-2 text-gray-700">Não</label></div></div>
              </div>
              <div>
                <label class="block text-gray-700 font-medium mb-2">Concluiu o Ensino Médio?<span class="text-[#B20000]">*</span></label>
                <div class="flex items-center space-x-4"><div class="flex items-center"><input type="radio" id="ensinoMedioSim" name="ensinoMedio" value="sim" required class="w-4 h-4 text-[#B20000] bg-gray-100 border-gray-300 focus:ring-[#B20000]"><label for="ensinoMedioSim" class="ml-2 text-gray-700">Sim</label></div><div class="flex items-center"><input type="radio" id="ensinoMedioNao" name="ensinoMedio" value="nao" required class="w-4 h-4 text-[#B20000] bg-gray-100 border-gray-300 focus:ring-[#B20000]"><label for="ensinoMedioNao" class="ml-2 text-gray-700">Não</label></div></div>
              </div>
              <div id="cursandoEnsinoMedioGroup" class="hidden-field">
                <label class="block text-gray-700 font-medium mb-2">Cursando o Ensino Médio<span class="text-[#B20000]">**</span></label>
                <div class="flex items-center space-x-4"><div class="flex items-center"><input type="radio" id="terceiraSerie" name="cursandoEnsinoMedio" value="3a" class="w-4 h-4 text-[#B20000] bg-gray-100 border-gray-300 focus:ring-[#B20000]"><label for="terceiraSerie" class="ml-2 text-gray-700">3ª Série</label></div><div class="flex items-center"><input type="radio" id="segundaSerie" name="cursandoEnsinoMedio" value="2a" class="w-4 h-4 text-[#B20000] bg-gray-100 border-gray-300 focus:ring-[#B20000]"><label for="segundaSerie" class="ml-2 text-gray-700">2ª Série</label></div></div>
              </div>
            </div>
          </fieldset>
          
          <!-- Seção: Endereço -->
          <fieldset class="border-t-2 border-gray-200 pt-6">
            <legend class="text-xl font-bold text-[#005C6D] mb-4 px-2">Endereço</legend>
            <div class="space-y-4">
              <div class="flex space-x-2">
                <div class="w-1/2">
                  <label for="cepInput" class="block text-gray-700 font-medium mb-2">CEP<span class="text-[#B20000]">*</span></label>
                  <input type="text" id="cepInput" placeholder="00000-000" maxlength="9" required class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#B20000] focus:border-transparent transition duration-200"/>
                </div>
                <div class="w-1/2">
                  <label for="estadoInput" class="block text-gray-700 font-medium mb-2">Estado</label>
                  <input type="text" id="estadoInput" placeholder="UF" class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 bg-gray-200 focus:outline-none" readonly/>
                </div>
              </div>
              <div>
                <label for="enderecoInput" class="block text-gray-700 font-medium mb-2">Endereço</label>
                <input type="text" id="enderecoInput" placeholder="Rua, Avenida..." class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 bg-gray-200 focus:outline-none" readonly/>
              </div>
              <div>
                <label for="bairroInput" class="block text-gray-700 font-medium mb-2">Bairro</label>
                <input type="text" id="bairroInput" placeholder="Bairro" class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 bg-gray-200 focus:outline-none" readonly/>
              </div>
              <div>
                <label for="cidadeInput" class="block text-gray-700 font-medium mb-2">Cidade</label>
                <input type="text" id="cidadeInput" placeholder="Cidade" class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 bg-gray-200 focus:outline-none" readonly/>
              </div>
              <div class="flex space-x-2">
                <div class="w-1/3">
                  <label for="numeroInput" class="block text-gray-700 font-medium mb-2">Número<span class="text-[#B20000]">*</span></label>
                  <input type="text" id="numeroInput" placeholder="000" required class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#B20000] focus:border-transparent transition duration-200"/>
                </div>
                <div class="w-2/3">
                  <label for="complementoInput" class="block text-gray-700 font-medium mb-2">Complemento</label>
                  <input type="text" id="complementoInput" placeholder="Apto, Bloco..." class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#B20000] focus:border-transparent transition duration-200"/>
                </div>
              </div>
            </div>
          </fieldset>

          <!-- Seção: Dados de Inscrição -->
          <fieldset class="border-t-2 border-gray-200 pt-6">
            <legend class="text-xl font-bold text-[#005C6D] mb-4 px-2">Dados de Inscrição</legend>
            <div class="space-y-4">
              <div>
                <label for="primeiraOpcaoCurso" class="block text-gray-700 font-medium mb-2">1ª Opção de Curso<span class="text-[#B20000]">*</span></label>
                <select id="primeiraOpcaoCurso" required class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#B20000] focus:border-transparent transition duration-200">
                  <option value="">Selecione um curso</option><option value="Técnico em Administração">Técnico em Administração</option><option value="Técnico em Edificações">Técnico em Edificações</option><option value="Técnico em Logística">Técnico em Logística</option><option value="Técnico em Recursos Humanos">Técnico em Recursos Humanos</option>
                </select>
              </div>
              <div id="segundaOpcaoGroup" class="hidden-field">
                <label for="segundaOpcaoCurso" class="block text-gray-700 font-medium mb-2">2ª Opção de Curso</label>
                <select id="segundaOpcaoCurso" class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#B20000] focus:border-transparent transition duration-200"></select>
              </div>
            </div>
          </fieldset>
          
          <!-- Seção: Termos e Declarações -->
          <fieldset class="border-t-2 border-gray-200 pt-6">
            <legend class="text-xl font-bold text-[#005C6D] mb-4 px-2">Termos e Declarações</legend>
            <div class="space-y-6">
              <div class="relative flex items-start"><div class="flex h-6 items-center"><input id="aceiteEdital" name="aceiteEdital" type="checkbox" required class="h-4 w-4 rounded border-gray-300 text-[#B20000] focus:ring-[#B20000]"></div><div class="ml-3 text-sm leading-6"><label for="aceiteEdital" class="text-gray-700">DECLARO QUE LI TODAS AS INFORMAÇÕES PREVISTAS NO <a href="#" target="_blank" rel="noopener noreferrer" class="font-medium text-[#B20000] hover:underline">EDITAL</a><span class="text-[#B20000]">*</span></label></div></div>
              <div class="relative flex items-start"><div class="flex h-6 items-center"><input id="aceiteCronograma" name="aceiteCronograma" type="checkbox" required class="h-4 w-4 rounded border-gray-300 text-[#B20000] focus:ring-[#B20000]"></div><div class="ml-3 text-sm leading-6"><label for="aceiteCronograma" class="text-gray-700">Declaro que tomei conhecimento do cronograma estabelecido no edital, incluindo a data de realização da prova em 27/08/2025 às 19h na Etec de Guaianazes (Rua Feliciano de Mendonça, 290)<span class="text-[#B20000]">*</span></label></div></div>
              <div class="relative flex items-start"><div class="flex h-6 items-center"><input id="autorizacaoLgpd" name="autorizacaoLgpd" type="checkbox" required class="h-4 w-4 rounded border-gray-300 text-[#B20000] focus:ring-[#B20000]"></div><div class="ml-3 text-sm leading-6"><label for="autorizacaoLgpd" class="text-gray-700">AUTORIZO A ETEC DE GUAIANAZES a utilizar os dados fornecidos somente para os fins de matrícula no curso que escolhi e acadêmicos, em conformidade com a LGPD, garantindo que serão adotadas as medidas de segurança necessárias para proteger meus dados pessoais contra acesso não autorizado, vazamento, alteração e outras formas de tratamento inadequado.<span class="text-[#B20000]">*</span></label></div></div>
              <div class="relative flex items-start"><div class="flex h-6 items-center"><input id="autorizacaoComunicacao" name="autorizacaoComunicacao" type="checkbox" required class="h-4 w-4 rounded border-gray-300 text-[#B20000] focus:ring-[#B20000]"></div><div class="ml-3 text-sm leading-6"><label for="autorizacaoComunicacao" class="text-gray-700">AUTORIZO A ETEC DE GUAIANAZES a enviar notificação, e-mail, mensagem de texto (SMS ou WhatsApp) conforme nossa <a href="https://etecguaianazes.cps.sp.gov.br/politica-de-privacidade/" target="_blank" rel="noopener noreferrer" class="font-medium text-[#B20000] hover:underline">política de privacidade</a>.<span class="text-[#B20000]">*</span></label></div></div>
            </div>
          </fieldset>
          
          <button
            type="submit"
            id="submitButton"
            class="w-full bg-[#B20000] text-white font-bold py-3 px-4 rounded-lg hover:bg-[#8e0000] transition duration-200 shadow-md"
          >
            Enviar Inscrição
          </button>
        </div>

        <div id="message" class="mt-6 text-center text-base font-medium hidden"></div>
      </form>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
        // --- Seleção de Elementos ---
        const sectionCpf = document.getElementById('section-cpf');
        const cpfInput = document.getElementById('cpfInput');
        const dataNascimentoInput = document.getElementById('dataNascimentoInput');
        const nextButton = document.getElementById('nextButton');
        const sectionsPrincipal = document.getElementById('sections-principal');
        const contactForm = document.getElementById('contactForm');
        const nomeInput = document.getElementById('nomeInput');
        const nomeSocialInput = document.getElementById('nomeSocialInput');
        const documentacaoNomeSocialGroup = document.getElementById('documentacaoNomeSocialGroup');
        const documentacaoNomeSocialInput = document.getElementById('documentacaoNomeSocialInput');
        const rgInput = document.getElementById('rgInput');
        const ufInput = document.getElementById('ufInput');
        const orgaoEmissorInput = document.getElementById('orgaoEmissorInput');
        const celularInput = document.getElementById('celularInput');
        const emailInput = document.getElementById('emailInput');
        const deficienciaRadios = document.querySelectorAll('input[name="candidatoDeficiencia"]');
        const tipoDeficienciaGroup = document.getElementById('tipoDeficienciaGroup');
        const tipoDeficienciaInput = document.getElementById('tipoDeficienciaInput');
        const teaRadios = document.querySelectorAll('input[name="candidatoTEA"]');
        const ensinoMedioRadios = document.querySelectorAll('input[name="ensinoMedio"]');
        const cursandoEnsinoMedioGroup = document.getElementById('cursandoEnsinoMedioGroup');
        const cursandoEnsinoMedioRadios = document.querySelectorAll('input[name="cursandoEnsinoMedio"]');
        const cepInput = document.getElementById('cepInput');
        const enderecoInput = document.getElementById('enderecoInput');
        const bairroInput = document.getElementById('bairroInput');
        const cidadeInput = document.getElementById('cidadeInput');
        const estadoInput = document.getElementById('estadoInput');
        const numeroInput = document.getElementById('numeroInput');
        const complementoInput = document.getElementById('complementoInput');
        const messageBox = document.getElementById('message');
        const submitButton = document.getElementById('submitButton');
        const primeiraOpcaoCurso = document.getElementById('primeiraOpcaoCurso');
        const segundaOpcaoGroup = document.getElementById('segundaOpcaoGroup');
        const segundaOpcaoCurso = document.getElementById('segundaOpcaoCurso');
        const aceiteEdital = document.getElementById('aceiteEdital');
        const aceiteCronograma = document.getElementById('aceiteCronograma');
        const autorizacaoLgpd = document.getElementById('autorizacaoLgpd');
        const autorizacaoComunicacao = document.getElementById('autorizacaoComunicacao');
        const cursos = ["Técnico em Administração", "Técnico em Edificações", "Técnico em Logística", "Técnico em Recursos Humanos"];

        // --- Lógica de Campos Condicionais ---
        nomeSocialInput.addEventListener('input', () => {
            if (nomeSocialInput.value.trim() !== '') {
                documentacaoNomeSocialGroup.classList.remove('hidden-field');
                documentacaoNomeSocialInput.setAttribute('required', 'required');
            } else {
                documentacaoNomeSocialGroup.classList.add('hidden-field');
                documentacaoNomeSocialInput.removeAttribute('required');
            }
        });

        deficienciaRadios.forEach(radio => {
            radio.addEventListener('change', () => {
                if (document.getElementById('deficienciaSim').checked) {
                    tipoDeficienciaGroup.classList.remove('hidden-field');
                    tipoDeficienciaInput.setAttribute('required', 'required');
                } else {
                    tipoDeficienciaGroup.classList.add('hidden-field');
                    tipoDeficienciaInput.removeAttribute('required');
                }
            });
        });

        ensinoMedioRadios.forEach(radio => {
            radio.addEventListener('change', () => {
                if (document.getElementById('ensinoMedioNao').checked) {
                    cursandoEnsinoMedioGroup.classList.remove('hidden-field');
                    cursandoEnsinoMedioRadios.forEach(r => r.setAttribute('required', 'required'));
                } else {
                    cursandoEnsinoMedioGroup.classList.add('hidden-field');
                    cursandoEnsinoMedioRadios.forEach(r => r.removeAttribute('required'));
                }
            });
        });

        primeiraOpcaoCurso.addEventListener('change', () => {
            const selectedValue = primeiraOpcaoCurso.value;
            segundaOpcaoCurso.innerHTML = '';
            if (selectedValue) {
                const opcoesDisponiveis = cursos.filter(curso => curso !== selectedValue);
                const defaultOption = document.createElement('option');
                defaultOption.value = "";
                defaultOption.textContent = "Selecione a 2ª opção (opcional)";
                segundaOpcaoCurso.appendChild(defaultOption);
                opcoesDisponiveis.forEach(curso => {
                    const option = document.createElement('option');
                    option.value = curso;
                    option.textContent = curso;
                    segundaOpcaoCurso.appendChild(option);
                });
                segundaOpcaoGroup.classList.remove('hidden-field');
            } else {
                segundaOpcaoGroup.classList.add('hidden-field');
            }
        });

        // --- Máscaras de Entrada ---
        function maskCPF(value) { return value.replace(/\D/g, "").replace(/(\d{3})(\d)/, "$1.$2").replace(/(\d{3})(\d)/, "$1.$2").replace(/(\d{3})(\d{1,2})$/, "$1-$2"); }
        function maskRG(value) { return value.toUpperCase().replace(/[^0-9X]/g, "").replace(/(\d{2})(\d)/, "$1.$2").replace(/(\d{3})(\d)/, "$1.$2").replace(/(\d{3})([0-9X]{1})$/, "$1-$2");}
        function maskCelular(value) { return value.replace(/\D/g, "").replace(/^(\d{2})(\d)/g, "($1) $2").replace(/(\d)(\d{4})$/, "$1-$2"); }
        function maskCEP(value) { return value.replace(/\D/g, "").replace(/^(\d{5})(\d)/, "$1-$2"); }

        cpfInput.addEventListener('input', (e) => { e.target.value = maskCPF(e.target.value); });
        rgInput.addEventListener('input', (e) => { e.target.value = maskRG(e.target.value); });
        celularInput.addEventListener('input', (e) => { e.target.value = maskCelular(e.target.value); });
        cepInput.addEventListener('input', (e) => { e.target.value = maskCEP(e.target.value); });

        // --- API e Lógica de Submissão ---
        cepInput.addEventListener('blur', (e) => {
          const cep = e.target.value.replace(/\D/g, "");
          if (cep.length === 8) {
            showMessage("Buscando endereço...", "text-gray-500");
            google.script.run.withSuccessHandler(onCEPAddressSuccess).withFailureHandler(onError).getAddressByCEP(cep);
          }
        });

        function onCEPAddressSuccess(data) {
          if (data.erro) {
            showMessage(data.erro, "text-[#B20000]");
            clearAddressFields();
          } else {
            enderecoInput.value = data.endereco;
            bairroInput.value = data.bairro;
            cidadeInput.value = data.cidade;
            estadoInput.value = data.estado;
            showMessage("Endereço encontrado!", "text-green-600");
            numeroInput.focus();
          }
        }

        nextButton.addEventListener('click', (e) => {
            e.preventDefault();
            if (cpfInput.checkValidity() && dataNascimentoInput.checkValidity()) {
                const cpf = cpfInput.value.replace(/\D/g, "");
                if (cpf.length !== 11) { showMessage("Por favor, insira um CPF válido com 11 dígitos.", "text-[#B20000]"); return; }
                setButtonLoading(nextButton, true);
                showMessage("Verificando CPF...", "text-gray-500");
                google.script.run.withSuccessHandler(onCpfCheckSuccess).withFailureHandler(onError).checkCpfInSheet(cpf);
            } else {
                showMessage("Por favor, preencha o CPF e a Data de Nascimento.", "text-[#B20000]");
            }
        });

        function onCpfCheckSuccess(isCpfRegistered) {
            if (isCpfRegistered) {
                showMessage("Inscrição já realizada para este CPF.", "text-[#B20000]");
                setButtonLoading(nextButton, false);
            } else {
                showMessage("CPF verificado. Preencha os dados restantes.", "text-green-600");
                sectionCpf.classList.add('hidden-field');
                sectionsPrincipal.classList.remove('hidden-field');
                setButtonLoading(nextButton, false);
            }
        }

        contactForm.addEventListener('submit', (e) => {
          e.preventDefault();
          if (!contactForm.checkValidity()) {
              showMessage("Por favor, preencha todos os campos obrigatórios (*).", "text-[#B20000]");
              return;
          }
          
          setButtonLoading(submitButton, true);
          showMessage("Enviando sua inscrição...", "text-gray-500");

          const formData = {
            cpf: cpfInput.value.replace(/\D/g, ""),
            dataNascimento: dataNascimentoInput.value,
            nome: nomeInput.value,
            nomeSocial: nomeSocialInput.value,
            rg: rgInput.value.toUpperCase().replace(/[^0-9X]/g, ""),
            ufRg: ufInput.value,
            orgaoEmissor: orgaoEmissorInput.value,
            celular: celularInput.value.replace(/\D/g, ""),
            email: emailInput.value,
            candidatoDeficiencia: document.querySelector('input[name="candidatoDeficiencia"]:checked')?.value || '',
            tipoDeficiencia: tipoDeficienciaInput.value,
            candidatoTEA: document.querySelector('input[name="candidatoTEA"]:checked')?.value || '',
            concluiuEnsinoMedio: document.querySelector('input[name="ensinoMedio"]:checked')?.value || '',
            cursandoEnsinoMedio: document.querySelector('input[name="cursandoEnsinoMedio"]:checked')?.value || '',
            cep: cepInput.value.replace(/\D/g, ""),
            endereco: enderecoInput.value,
            bairro: bairroInput.value,
            cidade: cidadeInput.value,
            estado: estadoInput.value,
            numero: numeroInput.value,
            complemento: complementoInput.value,
            primeiraOpcaoCurso: primeiraOpcaoCurso.value,
            segundaOpcaoCurso: segundaOpcaoCurso.value,
            aceiteEdital: aceiteEdital.checked,
            aceiteCronograma: aceiteCronograma.checked,
            autorizacaoLgpd: autorizacaoLgpd.checked,
            autorizacaoComunicacao: autorizacaoComunicacao.checked
          };

          const file = documentacaoNomeSocialInput.files[0];

          if (file) {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = () => {
              const fileData = reader.result;
              const base64Data = fileData.split(',')[1];
              formData.documentacaoNomeSocial = {
                fileName: file.name,
                mimeType: file.type,
                base64Data: base64Data
              };
              sendDataToGoogle(formData);
            };
            reader.onerror = (error) => {
              onError({ message: 'Erro ao ler o arquivo: ' + error });
            };
          } else {
            formData.documentacaoNomeSocial = { fileName: '', mimeType: '', base64Data: '' };
            sendDataToGoogle(formData);
          }
        });

        function sendDataToGoogle(data) {
          google.script.run
            .withSuccessHandler(onSuccess)
            .withFailureHandler(onError)
            .processForm(data);
        }

        function onSuccess(response) {
          showMessage(response, "text-green-600");
          contactForm.reset();
          clearAddressFields();
          setButtonLoading(submitButton, false);
          documentacaoNomeSocialGroup.classList.add('hidden-field');
          tipoDeficienciaGroup.classList.add('hidden-field');
          cursandoEnsinoMedioGroup.classList.add('hidden-field');
          segundaOpcaoGroup.classList.add('hidden-field');
          sectionsPrincipal.classList.add('hidden-field');
          sectionCpf.classList.remove('hidden-field');
          window.scrollTo(0, 0);
        }

        function onError(error) {
          showMessage("Ocorreu um erro: " + error.message, "text-[#B20000]");
          setButtonLoading(submitButton, false);
          setButtonLoading(nextButton, false);
        }
        
        // --- Funções Auxiliares ---
        function showMessage(text, colorClass) {
          messageBox.textContent = text;
          messageBox.className = 'mt-6 text-center text-base font-medium';
          messageBox.classList.add(colorClass);
          messageBox.classList.remove('hidden');
        }
        
        function setButtonLoading(button, isLoading) {
            button.disabled = isLoading;
            if (isLoading) {
                button.classList.add('opacity-50', 'cursor-not-allowed');
            } else {
                button.classList.remove('opacity-50', 'cursor-not-allowed');
            }
        }

        function clearAddressFields() {
          enderecoInput.value = '';
          bairroInput.value = '';
          cidadeInput.value = '';
          estadoInput.value = '';
        }
      });
    </script>
  </body>
</html>
